<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Test de primalidad de Miller-Rabin | SK Source</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Test de primalidad de Miller-Rabin" />
<meta property="og:locale" content="es_ES" />
<meta name="description" content="Bienvenidos al sitio web personal de SK Source. Aquí encontrarás contenido sobre matemáticas, programación y arte. Aún queda un gran camino que recorrer pero espero que me apoyéis a seguir adelante." />
<meta property="og:description" content="Bienvenidos al sitio web personal de SK Source. Aquí encontrarás contenido sobre matemáticas, programación y arte. Aún queda un gran camino que recorrer pero espero que me apoyéis a seguir adelante." />
<link rel="canonical" href="https://sksourcedata.github.io//math/information-theory/cryptography/miller-rabin-primality-test.html" />
<meta property="og:url" content="https://sksourcedata.github.io//math/information-theory/cryptography/miller-rabin-primality-test.html" />
<meta property="og:site_name" content="SK Source" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Test de primalidad de Miller-Rabin" />
<script type="application/ld+json">
{"headline":"Test de primalidad de Miller-Rabin","@type":"WebPage","url":"https://sksourcedata.github.io//math/information-theory/cryptography/miller-rabin-primality-test.html","description":"Bienvenidos al sitio web personal de SK Source. Aquí encontrarás contenido sobre matemáticas, programación y arte. Aún queda un gran camino que recorrer pero espero que me apoyéis a seguir adelante.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://sksourcedata.github.io//feed.xml" title="SK Source" /><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-183860687-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-183860687-1');
</script></head>


<body>

    <header class="site-header">

    <div class="wrapper"><a class="site-title" rel="author" href="/">SK Source</a><nav class="site-nav">
            <input type="checkbox" id="nav-trigger" class="nav-trigger" />
            <label for="nav-trigger">
                <span class="menu-icon">
                    <svg viewBox="0 0 18 15" width="18px" height="15px">
                        <path
                            d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" />
                    </svg>
                </span>
            </label>

            <div class="trigger">
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                    <a class="page-link" href="/art/">Arte</a>
                
                
                
                
                
                
                
                
                
                
                
                
                
                    <a class="page-link" href="/math/">Matemáticas</a>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                    <a class="page-link" href="/programming/">Programación</a>
                
                
                
                
                
                    <a class="page-link" href="/about/">Sobre mí</a>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </div>
        </nav></div>
</header>

    <main class="page-content" aria-label="Content">
        <div class="wrapper">
            
                <div style="color:rgb(120, 120, 121);border: 2px solid rgb(247, 204, 17);padding: 2px">
                    &#9888;Esta página aún se encuentra en desarrollo.
                </div>
                <!--<div style="color:rgb(120, 120, 121);border: 2px solid rgb(10, 154, 250);padding: 2px">
                    &#8505;Información
                </div>-->
            

            <article class="post">

  <header class="post-header">
    <h1 class="post-title">Test de primalidad de Miller-Rabin</h1>
  </header>

  <div class="post-content">
    <h2 id="preliminares">Preliminares</h2>

<dl class="l">
  <dt>Lema</dt>
  <dd>Sea n un primo impar y n − 1 = 2s d, con d impar. Si a ∈ Z∗n entonces ad ≡n 1 o
r
existe k , 0 &lt; r &lt; s − 1 tal que a2 d ≡n −1.</dd>
</dl>

<dl class="p">
  <dt>Demostración</dt>
  <dd>En primer lugar, es claro que ord(a) es un divisor de 2s d, de donde ord(ad )= 2k para
algún k, 0 ≤ k ≤ s. En caso de que k = 0, entonces ad ≡n 1. En caso contrario,
k −1
k
(ad )2
6≡n 1 y (ad )2 ≡n 1. Pero como 1 tiene solo dos raı́ces, ±1, dado que n es
k −1
d
2
impar, entonces (a )
≡n −1</dd>
</dl>

<h2 id="falsos-testigos">Falsos testigos</h2>

<dl class="d">
  <dt>Definición</dt>
  <dd>Sea n ∈ N un número impar. Entonces:
Se dice que a es un testigo falso de Fermat si an−1 ≡n 1.
Diremos que a es un testigo falso de Euler si a(n−1)/2 ≡n
 
a
.
n
Sea n − 1 = 2s d. Se dice que a es un testigo falso consistente si ad ≡n 1 o existe
k
k ∈ {0, . . . , s − 1} tal que ad2 ≡n −1.</dd>
</dl>

<dl class="e">
  <dt>Ejemplo</dt>
  <dd>Sea n = 65 y denotemos por F (65), E(65), S(65), los conjuntos de testigos falsos de
Fermat, testigos falsos de Euler y testigos falsos consistentes, respectivamente.
Entonces:
F (65) = {1, 8, 12, 14, 18, 21, 27, 31, 34, 38, 44, 47, 51, 53, 57, 64}.
E(65) = {1, 8, 14, 18, 47, 51, 57, 64}.
S(65) = {1, 8, 18, 47, 57, 64}.
Puede observarse que S(65) ⊆ E(65) ⊆ F (65) y que tanto E(65) como F (65) son
subgrupos de U(Z65 ), mientras que S(65) no lo es.
3</dd>
</dl>

<dl class="t">
  <dt>Teorema</dt>
  <dd>Sea n ∈ N impar y sean S(n), E(n) y F (n) los conjuntos de testigos falsos
consistentes, testigos falsos de Euler y testigos falsos de Fermat para n
respectivamente. Entonces
S(n) ⊆ E(n) ⊆ F (n) ⊆ Z∗n
Además, S(n) =
Z∗n
si y solo si n es primo.</dd>
</dl>

<dl class="p">
  <dt>Demostración</dt>
  <dd>Si n es primo, por el lema anterior, se tiene que S(n) = Z∗n . Sea pues n compuesto, es
decir, producto de al menos dos
primos distintos.
 
a
≡n a(n−1)/2 , de donde an−1 ≡n 1, y ası́
Si a ∈ E(n), entonces ±1 =
n
∗
E(n) ⊆ F (n) ⊆ Zn .
Sea pues a ∈ S(n) y n − 1 = 2s d, con d impar y sea k el menor entero tal que
k
e
e
a2 d ≡n 1. Entonces 0 ≤ k ≤ s − 1 y supongamos que n = p11 . . . pt t , con
pi , i = 1, . . . , t primos distintos.
Veamos en primer lugar el caso en el que k = 0. En tal caso, ad ≡pi 1 para todo
i = 1, . . . , t. De este modo, el orden en Zpi de a, oi , divide a d. Como d es impar,
entonces oi también es impar. Además oi divide a pi − 1 y, por tanto, a(pi −1)/2 ≡pi 1,
 
 
a
a
= 1. Ası́ pues
= 1 ≡n a(n−1)/2
lo que implica, por el criterio de Euler, que
pi
n
y, por tanto, a ∈ E(n).
k−1
Supongamos ahora que k &gt; 0. Entonces a2 d ≡n −1. De este modo, para todo
k
k −1
i = 1, . . . , t, se tiene que a2 d ≡pi 1 y a2 d ≡pi −1. Ası́, el orden de a en Zpi , oi ,
k
k
−1
divide a 2 d, pero no divide a 2
d, con lo que oi = 2k di , con di impar. Dado que oi
divide a pi − 1, entonces 2k divide a pi − 1, de donde pi = 2k bi + 1 para un cierto
bi ∈ Z. Teniendo en cuenta que aoi /2 ≡pi −1, se tiene, por el criterio de Euler,
 
k
k
a
≡pi a(oi /2)·(pi −1)/oi ≡pi (−1)(pi −1)/oi ≡pi (−1)(pi −1)/(2 di ) ≡pi (−1)(pi −1)/2 ≡pi (−1)bi
pi
dado que di es impar. Por otro lado
n=
t
Y
i=1
e
pi i =
t
t
t
Y
Y
X
(2k bi + 1)ei ≡22k
(1 + 2k bi ei ) ≡22k 1 + 2k
bi ei
i=1
i=1
i=1
    <blockquote>
      <p>De este modo,
t
2s−1 d =
X
n−1
bi ei
≡2k 2k−1
2
i=1
con lo que
2s−k d ≡2
t
X
bi ei
i=1
por lo que finalmente, se sigue que
s−1
a(n−1)/2 = a2
≡n
d
= (a2
k −1
d 2s−k
)
≡n (−1)2
s−k
Pt
≡n (−1)
i=1
bi ei
 
t
t  ei
Y
Y
a
a
((−1)bi )ei ≡n
=
pi
n
i=1
i=1
y, por tanto, a ∈ E(n).</p>
    </blockquote>
  </dd>
</dl>

<dl class="t">
  <dt>Teorema de Miller-Rabin</dt>
  <dd>Si \(n\) es un número compuesto e impar, entonces
<em class="eq">\[ |S(n)|\leq\frac{1}{4}\varphi(n), \]</em>
excepto para \(n=9\), que en cuyo caso, \(|S(n)|=2.\)</dd>
</dl>

<dl class="p">
  <dt>Demostración</dt>
  <dd>Supongamos en primer lugar que n es un número de Carmichael y sea n = p1 . . . pt ,
t ≥ 3 primos distintos, con pi − 1 dividiendo a n − 1 para todo i = 1, . . . , t. Sean
s1 , . . . , st tales que n − 1 = 2si (pi − 1)di , con di impar para todo i = 1, . . . , t y
supongamos, sin perdida de generalidad, que s1 ≤ · · · ≤ st . Sea s = s1 .
s
Como Zn ∼
= Zp1 × · · · × Zpt , entonces, a(n−1)/2 ≡n 1, dado que
s
si −s
a(n−1)/2 ≡pi a(pi −1)d2
≡pi 1
1)/2s
Además, (n −
es par.
Distinguimos ahora dos casos:
El primer caso es que s = si para todo i = 1, . . . , t. En tal caso, (n − 1)/2s+1 es un
múltiplo impar de (pi − 1)/2. Entonces S(n) está contenido en el subgrupo
A1 = {x ∈ Z∗n : x (n−1)/2
s+1
≡n ±1}
Sea a(k1 , . . . , kt ) el elemento de Z∗n dado por el isomorfismo del Teorema del resto
k
k
chino tal que a(k1 , . . . , kt ) 7→ (g11 , . . . , gt t ), con gi un generador de Zpi para todo
s+1
i = 1, . . . , t. Entonces a(k1 , . . . , kt )(n−1)/2
≡n ±1 si y solo si todos los ki son pares
o impares a la vez. Como t ≥ 3, entonces |S(n)| ≤ 1/2t−1 Φ(n) ≤ 1/4Φ(n).
El segundo caso es que st &gt; s1 . Entonces (n − 1)/2s+1 es un múltiplo de pt − 1, y ası́
es par. De este modo,
s+1
S(n) ⊆ A0 = {x ∈ Z∗n : x (n−1)/2
≡n 1}
Como se tiene que A0 6= Z∗n , se sigue que |A0 | ≤ 1/2Φ(n). Además, se tiene que
S(n) ⊆ A2 = {x ∈ Z∗n : a(n−1)/2
s+2
≡n ±1}
que es un subgrupo de A0 . Entonces A2 ( A0 (Ejercicio). Por tanto,
|S(n)| ≤ |A2 | ≤ 1/2|A0 | ≤ 1/4Φ(n)
.
Queda probar el caso en el que n no es un número de Carmichael.
Se sabe que S(n) ⊆ F (n) ( Z∗n y que |F (n)| ≤ 1/2Φ(n).
Se deja como ejercicio el resto de la demostración, para lo que hay que construir un
subgrupo W ⊆ F (n) tal que
1
S(n) ⊆ W .
2
W ( F (n).
l
Ayuda: Sea W = {x ∈ Z∗n : x 2 d ≡n ±1 para algún i}.</dd>
</dl>

<h2 id="test-de-miller-rabin">Test de Miller-Rabin</h2>

<p>Sea n = 2s d ∈ Z impar, con d impar.</p>
<ol>
  <li>Se escogen a1 , . . . , at ∈ Z∗n y tales que mcd(ai , n) = 1, i = 1, . . . , t.</li>
  <li>Para cada i = 1, . . . , t, comprobar
aid ≡n 1.
l
aid2 ≡n −1 para l = 0, . . . , s − 1.</li>
</ol>

<p>Si ninguna de las dos cosas sucede, entonces n no es primo (por el primer lema). En
caso contrario, n es primo con una probabilidad de, al menos, 1 − (1/4)t.</p>

<h2 id="un-test-determinista">Un test determinista</h2>

<p>Tal y como se dijo previamente, Agraval, Kayal y Saxena probaron que el problema de
determinar si un número es o no primo tiene complejidad de orden polinomial. El
algoritmo que proporcionan es de orden O(log12 (n)) (demasiado alto para llevarlo a la
práctica). Su idea es usar el siguiente hecho:</p>

<dl class="l">
  <dt>Lema</dt>
  <dd>Para todo a ∈ Z∗n , se tiene que (x + a)n ≡n x n + a si y solo si n es primo.</dd>
</dl>

<dl class="p">
  <dt>Demostración</dt>
  <dd>Si n es primo, entonces (x + y)n = x n + y n en Zn [x, y], y por el Pequeño Teorema de
Fermat an ≡n a si a ∈ Z∗n.</dd>
</dl>

  </div>

</article>

        </div>
    </main>

    <!--
        <div id="disqus_thread"></div>
        <script>
            /**
            *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
            *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
            /*
            var disqus_config = function () {
            this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };
            */
            (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://sksource.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    -->
    <footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">SK Source</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">SK Source</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://instagram.com/sksource_art"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#instagram"></use></svg> <span class="username">sksource_art</span></a></li><li><a href="https://www.twitter.com/sksource_art"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">sksource_art</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Bienvenidos al sitio web personal de SK Source. Aquí encontrarás contenido  sobre matemáticas, programación y arte. Aún queda un gran camino que recorrer  pero espero que me apoyéis a seguir adelante.</p>
      </div>
    </div>

  </div>

</footer>

</body>

</html>


    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://example.com/mathjax/MathJax.js?config=TeX-AMS_CHTML&locale=fr"></script>
